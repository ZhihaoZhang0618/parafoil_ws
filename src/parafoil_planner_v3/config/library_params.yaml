parafoil_planner_v3:
  ros__parameters:
    generation:
      method: "gpm"            # template | gpm
      # Medium grid (6-DOF). For a dense grid, use library_params_full.yaml.
      wind_speeds: [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0]
      wind_directions: [0, 90, 180, 270]
      initial_altitudes: [50, 80, 120]
      target_distances: [100, 150, 200, 250, 300]
      target_bearings: [0, 90, 180, 270]
      trajectory_types: ["DIRECT", "S_TURN"]

      # Parallelism (GPM only)
      num_workers: "auto"

      # GPM settings (GPM only)
      gpm:
        method: "SLSQP"
        solve_mode: "least_squares"  # least_squares (robust) | minimize (strict constraints)
        dynamics_mode: "simplified"  # simplified (fast) | 6dof (high-fidelity, slow)
        num_nodes: 10
        scheme: "LGL"
        max_iterations: 150
        tolerance: 1.0e-6
        # Trajectory-type shaping via reference control tracking
        w_u_ref: 2.0
        delta_a_amp: 0.4
        s_turn_cycles: 2.0
        spiral_delta_a_sign: 1.0
        rollout_dt: 0.2
        # Symmetric brake baseline bounds
        brake_min: 0.0
        brake_max: 0.6
        brake_fallback: 0.2
        # Acceptance threshold
        max_violation_accept: 0.5
        lsq_max_nfev: 15
        lsq_w_dynamics: 1.0
        lsq_w_boundary: 10.0
        lsq_w_ineq: 10.0
        # Shape constraints (post-check, stronger topology/geometry than u_ref alone)
        shape_enforce: true
        shape_turn_eps_deg: 3.0
        direct_max_total_turn_deg: 60.0
        direct_max_net_turn_deg: 45.0
        s_turn_min_total_turn_deg: 90.0
        s_turn_max_net_turn_deg: 45.0
        s_turn_min_sign_changes: 1
        racetrack_min_total_turn_deg: 150.0
        racetrack_max_net_turn_deg: 60.0
        racetrack_min_turn_clusters: 2
        racetrack_min_turn_fraction: 0.75
        spiral_min_turns: 1.0
        spiral_min_turn_fraction: 0.9

    matching:
      k_neighbors: 5
      feature_weights:
        altitude: 0.2
        distance: 0.25
        bearing: 0.15
        wind_speed: 0.2
        wind_angle: 0.2
